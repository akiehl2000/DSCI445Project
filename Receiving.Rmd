---
title: "Receiving Models"
author: "Adam Kiehl"
date: "11/24/21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GGally)
library(dlookr)
```

Read in the data and isolate relevant fields.
```{r, message=FALSE}
fileName <- './Data/masterDF[2018-2020].csv'
rec_data <- read_csv(fileName) %>%
  select(-'...1')
rec_data <- rec_data[, c(1:3, 17:23, 51:62)]

train_data <- rec_data[which(rec_data$Rec > 0 & !is.na(rec_data$RecLng)), -c(1:3)]
for (i in 1:nrow(train_data)) {
  if (is.na(train_data$FirstDRec[i])) {
    train_data$FirstDRec[i] <- 0
  }
  if (is.na(train_data$RecPerBr[i])) {
    train_data$RecPerBr[i] <- 0
  }
}

# fileName <- './Data/masterDF[2021-2021].csv'
# rec_data2021 <- read_csv(fileName) %>%
#   select(-'...1')
# rec_data2021 <- rec_data2021[, c(1:3, 17:23, 51:62)]
# 
# test_data <- rec_data2021[which(rec_data2021$Rec > 0 & !is.na(rec_data2021$RecLng)), -c(1:3)]
# for (i in 1:nrow(test_data)) {
#   if (is.na(test_data$FirstDRec[i])) {
#     test_data$FirstDRec[i] <- 0
#   }
#   if (is.na(test_data$RecPerBr[i])) {
#     test_data$RecPerBr[i] <- 0
#   }
# }
```

```{r}
diagnose(train_data)
```

```{r}
ggpairs(train_data[,c(2:4, 7)])
```

Model `Rec`
```{r}
summary(lm(Rec ~ . - RecYds - RecTD - FL, data = train_data))
```

Model `RecYds`
```{r}
summary(lm(RecYds ~ . - Rec - RecTD - FL, data = train_data))
```

Model `RecTD`
```{r}
summary(lm(RecTD ~ . - Rec - RecYds - FL, data = train_data))
```

Model `FL`
```{r}
summary(lm(FL ~ . - Rec - RecYds - RecTD, data = train_data))
```

Modeling Procedure:

- Backward/forward selection
- LASSO/Ridge
- Regression (are assumptions met? how can we improve this?)
- Non-linear regression (Is this necessary?)
- PCA (many of our predictors are likely correllated)
- Tree based models
- All fit using k fold cross validation
- Predict on typical game averages
- Test against 2021 data






